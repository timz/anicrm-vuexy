# CLAUDE.md

Этот файл предоставляет руководство для Claude Code (claude.ai/code) при работе с кодом в этом репозитории.

## ВАЖНО: Цель проекта

**Это проект по переносу функциональности из spa-vuetify и full-version в starter-kit.**

### Ключевые правила переноса:
- **НЕ РЕДАКТИРУЕМ spa-vuetify и full-version** - используем только как источники для изучения логики
- **ВСЯ РАБОТА ведется в starter-kit** - туда переносим компоненты и функциональность
- **spa-vuetify** - старый проект с бизнес-логикой (ТОЛЬКО ДЛЯ ЧТЕНИЯ)
- **full-version** - источник для изучения реализации UI и компонентов
- **starter-kit** - целевая директория для всех изменений

### Важные изменения в архитектуре:
- **Система API полностью заменена** - вместо ofetch и useApi теперь используется Axios из spa-vuetify
- **Хранение токенов** - используется localStorage вместо cookie (как в spa-vuetify)
- **Все HTTP-запросы** должны использовать `secureApi` или `api` из `src/services/AxiosService.ts`

### Алгоритм переноса логики из spa-vuetify:
1. **Анализ** - изучить что делает исходный компонент или класс в spa-vuetify
2. **Поиск альтернатив** - проверить, есть ли в starter-kit готовый механизм для решения этой задачи
3. **Использование существующих решений** - если механизм есть, применить его, следуя архитектуре starter-kit, а не копируя старую логику напрямую
4. **Конвертация** - если готового решения нет, адаптировать старую логику под архитектуру starter-kit

### КРИТИЧЕСКИ ВАЖНО:
- **ЗАПРЕЩЕНО добавлять что-либо от себя в бизнес-логику**
- **ЗАПРЕЩЕНО удалять части бизнес-логики**
- **Бизнес-логика должна быть перенесена полностью и без изменений по функциональности**

## Структура проекта

Проект содержит три основные директории:
- **spa-vuetify**: Старый проект с бизнес-логикой на Vuetify (ТОЛЬКО ДЛЯ ЧТЕНИЯ, источник бизнес-логики)
- **full-version**: Полный админ-шаблон Vuexy со всеми функциями и компонентами (ТОЛЬКО ДЛЯ ЧТЕНИЯ, источник UI-решений)
- **starter-kit**: Минимальная версия Vuexy для начала новых проектов (РАБОЧАЯ ДИРЕКТОРИЯ, куда переносим функциональность)

## Команды разработки

**ВАЖНО: Используем pnpm вместо npm для управления зависимостями!**

### Full Version (в директории `full-version/`) - ТОЛЬКО ДЛЯ СПРАВКИ
```bash
# Установка зависимостей
pnpm install

# Запуск сервера разработки
pnpm run dev

# Сборка для продакшена
pnpm run build

# Проверка типов
pnpm run typecheck

# Линтинг и исправление кода
pnpm run lint

# Сборка библиотеки иконок
pnpm run build:icons
```

### Starter Kit (в директории `starter-kit/`) - ОСНОВНАЯ РАБОЧАЯ ДИРЕКТОРИЯ
Те же команды, что и для full version, но с использованием pnpm.

## Обзор архитектуры

### Основные библиотеки и фреймворк
- **Vue 3** с Composition API
- **TypeScript** для типобезопасности
- **Vuetify 3** как библиотека UI-компонентов
- **Vue Router** с авто-роутингом через `unplugin-vue-router`
- **Pinia** для управления состоянием
- **Vite** как инструмент сборки

### Ключевая структура директорий
- `src/@core/`: Основные утилиты, компоненты и composables, общие для всего приложения
- `src/@layouts/`: Компоненты макетов и логика, специфичная для макетов
- `src/plugins/`: Плагины приложения (router, i18n, fake-api, конфигурация vuetify)
- `src/pages/`: Компоненты страниц с авто-роутингом
- `src/components/`: Переиспользуемые Vue-компоненты
- `src/composables/`: Vue composables для общей логики
- `src/views/`: Компоненты представлений (демо, примеры)
- `src/assets/`: Статические ресурсы, включая стили и изображения

### Алиасы путей
- `@/`: Ссылается на `src/`
- `@core/`: Ссылается на `src/@core/`
- `@layouts/`: Ссылается на `src/@layouts/`
- `@images/`: Ссылается на `src/assets/images/`
- `@styles/`: Ссылается на `src/assets/styles/`
- `@db/`: Ссылается на `src/plugins/fake-api/handlers/`
- `@api-utils/`: Ссылается на `src/plugins/fake-api/utils/`

### Авто-импорты
Проект использует `unplugin-auto-import` для автоматического импорта:
- Функций Vue composition API
- Утилит VueUse
- Функций Vue Router
- Хранилищ Pinia
- Функций i18n
- Пользовательских composables из `@core/utils`, `@core/composable/` и `src/composables/`

### Роутинг
- Использует файловый роутинг с `unplugin-vue-router`
- Страницы в `src/pages/` автоматически регистрируются как маршруты
- Имена маршрутов конвертируются из PascalCase в kebab-case
- Макеты обрабатываются через `vite-plugin-vue-meta-layouts`

### Аутентификация и авторизация
- CASL интегрирован для контроля доступа на основе ролей
- JWT-аутентификация с обработчиками fake API
- Утилиты аутентификации в `src/plugins/casl/`

### API и данные
- **Axios** для HTTP-запросов с полной системой interceptor'ов из spa-vuetify
- Сервис AxiosService в `src/services/AxiosService.ts` с:
  - Автоматическим обновлением токенов (refresh token)
  - Глобальным индикатором загрузки
  - Обработкой ошибок и уведомлениями
- EnvService в `src/services/EnvService.ts` для управления токенами и URL
- Система уведомлений в `src/composables/useNotifications.ts`
- Реализация Mock API в `src/plugins/fake-api/`
- MSW (Mock Service Worker) для имитации API

### Стилизация
- SCSS с темизацией Vuetify
- CSS-переменные настроены в `src/assets/styles/variables/_vuetify.scss`
- Утилитарные классы и пользовательские стили в `src/@core/scss/`

### Система иконок
- Интеграция Iconify с автогенерируемыми компонентами иконок
- Иконки из Material Design Icons, Font Awesome и Tabler
- Пользовательская система сборки иконок через `npm run build:icons`

### Качество кода
- ESLint с пользовательскими правилами и конфигурациями Vue/TypeScript
- Строгая конфигурация TypeScript
- Пользовательские правила ESLint для соблюдения соглашений проекта (алиасы путей, именование компонентов)
- Stylelint для линтинга SCSS