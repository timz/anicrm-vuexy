# QWEN.md - ПРОЕКТ ПЕРЕНОСА ANICRM VUEXY

## Общая информация

Это проект переноса для ANICRM, предназначенный для переноса функциональности из двух исходных проектов (`spa-vuetify` и `full-version`) в целевой проект (`starter-kit`). Проект использует Vue 3 с Vuetify 3 в качестве UI фреймворка, с TypeScript для безопасности типов и Vite как инструмент сборки.

### Основные детали архитектуры:

- **spa-vuetify**: Содержит бизнес-логику, которую необходимо перенести. Это исходник для функциональности.
- **full-version**: Полный админ-шаблон Vuexy, используемый в качестве справочника для UI компонентов и реализаций.
- **starter-kit**: Целевой проект, в который осуществляется перенос функциональности. Это рабочая директория для всех изменений.

### ВАЖНО: Все общение и документация осуществляется на русском языке

## Руководящие принципы переноса

### Критические правила:
- **НЕ РЕДАКТИРУЕМ** `spa-vuetify` и `full-version` - используем только как справочные источники
- **ВСЯ РАБОТА** происходит в `starter-kit` - это место назначения для всей функциональности
- **spa-vuetify** - старый проект с бизнес-логикой (ТОЛЬКО ДЛЯ ЧТЕНИЯ)
- **full-version** - справочник для UI и компонентов (ТОЛЬКО ДЛЯ ЧТЕНИЯ)
- **starter-kit** - активная рабочая директория для всех изменений

### Изменения в архитектуре:
- **Система API полностью заменена** - вместо ofetch и useApi теперь используется Axios из spa-vuetify
- **Хранение токенов** - использует localStorage вместо cookie (как в spa-vuetify)
- **Все HTTP-запросы** должны использовать `secureApi` или `api` из `src/services/AxiosService.ts`

### Алгоритм переноса:
1. **Анализ** - изучить, что делает исходный компонент или класс в spa-vuetify
2. **Поиск альтернатив** - проверить, есть ли в starter-kit готовый механизм для этой задачи
3. **Использование существующих решений** - если механизм существует, применить его, следуя архитектуре starter-kit вместо прямого копирования старой логики
4. **Конвертация** - если готового решения нет, адаптировать старую логику к архитектуре starter-kit

### Критические требования:
- **ЗАПРЕЩЕНО** добавлять кастомную бизнес-логику
- **ЗАПРЕЩЕНО** удалять части бизнес-логики
- **Бизнес-логика должна быть перенесена полностью** без изменений функциональности

## Стек технологий

- **Vue 3** с Composition API
- **TypeScript** для безопасности типов
- **Vuetify 3** как библиотека UI компонентов
- **Vue Router** с автосмаршрутизацией через `unplugin-vue-router`
- **Pinia** для управления состоянием
- **Vite** как инструмент сборки
- **Axios** для HTTP-запросов (вместо ofetch из оригинального шаблона Vuexy)
- **pnpm** для управления пакетами

## Структура проекта

### starter-kit (Рабочая директория)
Основная директория, где происходит разработка:
- `src/@core/`: Основные утилиты, компоненты и композаблы, общие для приложения
- `src/@layouts/`: Компоненты макетов и логика, специфичная для макетов
- `src/plugins/`: Плагины приложения (роутер, i18n, фейковое API, конфигурация vuetify)
- `src/pages/`: Компоненты страниц с автосмаршрутизацией
- `src/components/`: Переиспользуемые Vue-компоненты
- `src/composables/`: Vue композаблы для общего кода
- `src/views/`: Компоненты представлений (демо, примеры)
- `src/assets/`: Статические ресурсы, включая стили и изображения
- `src/modules/`: Модули бизнес-логики (adv-sources, auth, clients, dashboards, deals и т.д.)
- `src/crudui/`: CRUD UI компоненты

### spa-vuetify (Источник бизнес-логики)
Справочник для реализации бизнес-логики:
- `src/modules/`: Содержит те же модули, что и starter-kit, но с оригинальной бизнес-логикой
- `src/stores/`: Pinia хранилища с оригинальной бизнес-логикой
- `src/services/AxiosService.ts`: Содержит реализацию Axios, которая будет использоваться в starter-kit

### full-version (Справочник UI)
Полный шаблон Vuexy для справки по UI компонентам:
- Содержит все UI компоненты, страницы и функциональность полного шаблона
- Используется только как справочник для реализации UI элементов в starter-kit

## Основные конфигурации и сервисы

### Алиасы путей
- `@/`: Ссылается на `src/`
- `@core/`: Ссылается на `src/@core/`
- `@layouts/`: Ссылается на `src/@layouts/`
- `@images/`: Ссылается на `src/assets/images/`
- `@styles/`: Ссылается на `src/assets/styles/`
- `@db/`: Ссылается на `src/plugins/fake-api/handlers/`
- `@api-utils/`: Ссылается на `src/plugins/fake-api/utils/`

### Работа с API и данными
- **Axios** для HTTP-запросов с полной системой перехватчиков из spa-vuetify
- AxiosService в `src/services/AxiosService.ts` включает:
  - Автоматическое обновление токенов
  - Глобальный индикатор загрузки
  - Обработку ошибок и уведомления
- EnvService в `src/services/EnvService.ts` для управления токенами и URL
- Система уведомлений в `src/composables/useNotifications.ts`
- Реализация фейкового API в `src/plugins/fake-api/`
- MSW (Mock Service Worker) для имитации API

### Система иконок
- **Полностью перешли с MDI шрифтов на Iconify с CSS масками**
- Конфигурация иконок в `src/plugins/iconify/build-icons.ts`
- Генерация CSS масок через `pnpm run build:icons`
- Иконки используют CSS маски для отображения (mask-image с SVG data URL)
- Поддерживает Material Design Icons (mdi:*), Font Awesome (fa:*) и Tabler Icons
- Чтобы добавить новые иконки:
  1. Добавьте имя иконки в массив `icons` в `build-icons.ts`
  2. Запустите `pnpm run build:icons` для генерации CSS
  3. Используйте в компонентах как `icon="mdi-name"` или `class="mdi-name"`

## Команды разработки

**ВАЖНО: Используйте pnpm вместо npm для управления зависимостями!**

### В директории starter-kit (основная разработка):
```bash
# Установить зависимости
pnpm install

# Запустить сервер разработки
pnpm run dev

# Собрать для продакшена
pnpm run build

# Проверка типов
pnpm run typecheck

# Линтинг и исправление кода
pnpm run lint

# Собрать библиотеку иконок
pnpm run build:icons

# Предварительный просмотр продакшен сборки
pnpm run preview
```

## Контроль качества

- ESLint с пользовательскими правилами и настройками Vue/TypeScript
- Строгая конфигурация TypeScript
- Пользовательские правила ESLint для соблюдения конвенций проекта (алиасы путей, именование компонентов)
- Stylelint для линтинга SCSS

## Файловая маршрутизация

- Использует `unplugin-vue-router` для файловой маршрутизации
- Страницы в `src/pages/` автоматически регистрируются как маршруты
- Имена маршрутов преобразуются из PascalCase в kebab-case
- Макеты обрабатываются через `vite-plugin-vue-meta-layouts`